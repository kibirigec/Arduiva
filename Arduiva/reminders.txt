nice bg colors to expereiment:

#F4F7FC





#575f5f - 
nice very dark blue sort of color - alongside #F5FFCD for certain text, you'll know what to do
#151512





F8FAFD.  git




Define Actions:

Create action types in actionTypes.js.
Create action creators in actions.js to generate actions.
Create Reducers:

Define initial state and reducer functions in reducers.js.
Handle actions in the reducer functions to update the state.
Combine Reducers:

Combine multiple reducers into a single root reducer using combineReducers in reducers.js.
Create Store:

Import createStore from Redux in store.js.
Create the Redux store by passing the root reducer to createStore.
Export the created store from store.js.
Connect Components:

Import connect from react-redux in your components.
Connect the components to the Redux store using the connect function.
Map State to Props:

Define mapStateToProps function in your components to map the Redux state to component props.
Use mapStateToProps to access the Redux state in the component.
Dispatch Actions:

Use mapDispatchToProps function in your components to map action creators to component props.
Dispatch actions by calling the mapped action creators in your components.
Subscribe to Store Changes:

Subscribe to store changes using the useSelector hook or connect function in your components.
Update component state or UI based on store changes.
Dispatch Thunks or Async Actions (optional):

If needed, use middleware like redux-thunk to handle asynchronous actions or side effects.
Create thunks or async action creators to dispatch asynchronous actions.
Handle Side Effects (optional):

Use middleware like redux-saga or redux-observable to handle complex side effects or asynchronous logic.






import React, { useRef, useMemo, useState, useEffect } from 'react';
import { StyleSheet, View, SafeAreaView, Text, ActivityIndicator, TouchableOpacity, Pressable } from 'react-native';
import BottomSheet, { BottomSheetFlatList } from '@gorhom/bottom-sheet';
import { GestureHandlerRootView } from 'react-native-gesture-handler';
import MapView, { Marker } from 'react-native-maps';
import { FontAwesomeIcon } from '@fortawesome/react-native-fontawesome';
import { faChevronCircleLeft } from '@fortawesome/free-solid-svg-icons';
import { useSelector } from 'react-redux';
import { selectCurrentLocation } from '../Redux/slices/navSlice';

const MechanicScreen = ({ navigation }) => {
    const sheetRef = useRef(null);
    const mapRef = useRef(null); // Reference for the MapView
    const snapPoints = useMemo(() => ['40%', '65%'], []);
    const [snapIndex, setSnapIndex] = useState(0);
    const [mechanics, setMechanics] = useState([]);
    const [loading, setLoading] = useState(true);
    const [selectedMechanic, setSelectedMechanic] = useState(null);
    const currentLocation = useSelector(selectCurrentLocation);

    useEffect(() => {
        console.log('Current Location:', currentLocation); // Log current location
    }, [currentLocation]);

    useEffect(() => {
        // Simulate fetching data from an API
        setTimeout(() => {
            const fetchedMechanics = [
                { id: '1', name: 'Mechanic 1', distance: '1.2 km' },
                { id: '2', name: 'Mechanic 2', distance: '2.4 km' },
                { id: '3', name: 'Mechanic 3', distance: '3.1 km' },
                // Add more mechanics data here
            ];
            setMechanics(fetchedMechanics);
            setLoading(false);
        }, 2000); // Simulating a network request
    }, []);

    const handleSheetChanges = (index) => {
        console.log('handleSheetChanges', index);
        setSnapIndex(index);
        adjustMapRegion(index);
    };

    const adjustMapRegion = (index) => {
        if (!mapRef.current || !currentLocation) return;
        const bottomSheetHeight = index === 1 ? 300 : 150; // Adjust height based on snap point
        const offset = bottomSheetHeight * 0.00002; // Adjust this multiplier to fit your map scale
        const newRegion = {
            ...currentLocation,
            latitude: currentLocation.lat + offset, // Adjust latitude to keep marker centered
        };
        mapRef.current.animateToRegion(newRegion, 1000); // Animate to the new region
    };

    const handleMechanicSelect = (mechanic) => {
        setSelectedMechanic(mechanic);
    };

    const navigateToDetail = () => {
        if (selectedMechanic) {
            navigation.navigate('MechanicDetail', { mechanic: selectedMechanic });
        }
    };

    const renderItem = ({ item, index }) => (
        <TouchableOpacity
            style={[
                styles.item,
                item.id === selectedMechanic?.id && styles.selectedItem,
                index === mechanics.length - 1 && styles.lastItem, // Apply margin to the last item
            ]}
            onPress={() => handleMechanicSelect(item)}
        >
            <Text style={styles.name}>{item.name}</Text>
            <Text style={styles.distance}>{item.distance}</Text>
        </TouchableOpacity>
    );

    // Filter mechanics based on snapIndex
    const filteredMechanics = snapIndex === 0 ? mechanics.slice(0, 1) : mechanics;

    if (!currentLocation) {
        return <ActivityIndicator size="large" color="#0000ff" />;
    }

    return (
        <GestureHandlerRootView style={{ flex: 1 }}>
            <SafeAreaView style={styles.container}>
                <View style={styles.mapsView}>
                    <MapView
                        ref={mapRef}
                        style={styles.map}
                        initialRegion={{
                            latitude: currentLocation.lat,
                            longitude: currentLocation.lng,
                            latitudeDelta: 0.005,
                            longitudeDelta: 0.005,
                        }}
                    >
                        <Marker
                            coordinate={{ latitude: currentLocation.lat, longitude: currentLocation.lng }}
                            title="Current Location"
                        />
                    </MapView>
                    <TouchableOpacity>
                        <FontAwesomeIcon icon={faChevronCircleLeft} size={38} color='gray' style={{ position: 'absolute', bottom: 330, right: 144 }} />
                    </TouchableOpacity>
                </View>
                <BottomSheet
                    ref={sheetRef}
                    index={0}
                    snapPoints={snapPoints}
                    onChange={handleSheetChanges}
                    style={styles.bottomSheet}
                >
                    <View style={styles.headerContainer}>
                        <Text style={styles.headerText}>Nearest Mechanics</Text>
                    </View>
                    {loading ? (
                        <ActivityIndicator size="large" color="#0000ff" />
                    ) : (
                        <BottomSheetFlatList
                            data={filteredMechanics}
                            renderItem={renderItem}
                            keyExtractor={(item) => item.id}
                            contentContainerStyle={styles.flatListContent}
                            style={styles.flatList}
                        />
                    )}
                </BottomSheet>
                <View style={styles.bottomSheetFooter}>
                    {selectedMechanic && (
                        <Pressable onPress={navigateToDetail} style={styles.pressable}>
                            <Text style={styles.pressableText}>
                                {selectedMechanic.name} - {selectedMechanic.distance}
                            </Text>
                        </Pressable>
                    )}
                </View>
            </SafeAreaView>
        </GestureHandlerRootView>
    );
};

const styles = StyleSheet.create({
    container: {
        flex: 1,
        backgroundColor: '#fafafa',
    },
    mapsView: {
        flex: 1,
        justifyContent: 'center',
        alignItems: 'center',
    },
    map: {
        ...StyleSheet.absoluteFillObject,
    },
    bottomSheet: {
        backgroundColor: 'white',
        borderTopLeftRadius: 18,
        borderTopRightRadius: 18,
    },
    headerContainer: {
        paddingVertical: 10,
    },
    headerText: {
        textAlign: 'center',
        fontFamily: 'Asap-Medium',
        fontSize: 20,
    },
    flatListContent: {
        paddingBottom: 0, // Adjusted to make space for the sticky red view
        paddingHorizontal: 8,
    },
    flatList: {
        flex: 1,
    },
    item: {
        padding: 12,
        borderWidth: 1,
        borderColor: '#ccc',
        marginVertical: 5,
        borderRadius: 8,
    },
    selectedItem: {
        borderColor: 'black',
        borderWidth: 2,
    },
    lastItem: {
        marginBottom: 150, // Adjusted to make space for the sticky red view
    },
    name: {
        fontSize: 18,
        fontFamily: 'Asap-Medium',
    },
    distance: {
        color: '#666',
        fontFamily: 'Asap-Medium',
    },
    pressable: {
        backgroundColor: '#000',
        padding: 16,
        borderRadius: 8,
        width: '80%'
    },
    pressableText: {
        textAlign: 'center',
        fontSize: 18,
        fontFamily: 'Asap-Medium',
        color: '#fafafa',
    },
    bottomSheetFooter: {
        backgroundColor: 'white',
        borderTopWidth: 1,
        borderTopColor: '#000',
        height: 120,
        justifyContent: 'center',
        alignItems: 'center',
        position: 'absolute',
        bottom: 0,
        left: 0,
        right: 0,
    },
});

export default MechanicScreen;
